/*
THIS IS A GENERATED/BUNDLED FILE BY ESBUILD
if you want to view the source, please visit the github repository of this plugin
*/

var ss=Object.create;var ne=Object.defineProperty;var os=Object.getOwnPropertyDescriptor;var us=Object.getOwnPropertyNames;var ls=Object.getPrototypeOf,cs=Object.prototype.hasOwnProperty;var ze=e=>ne(e,"__esModule",{value:!0});var s=(e,r)=>()=>(r||e((r={exports:{}}).exports,r),r.exports),ps=(e,r)=>{ze(e);for(var t in r)ne(e,t,{get:r[t],enumerable:!0})},fs=(e,r,t)=>{if(r&&typeof r=="object"||typeof r=="function")for(let a of us(r))!cs.call(e,a)&&a!=="default"&&ne(e,a,{get:()=>r[a],enumerable:!(t=os(r,a))||t.enumerable});return e},P=e=>fs(ze(ne(e!=null?ss(ls(e)):{},"default",e&&e.__esModule&&"default"in e?{get:()=>e.default,enumerable:!0}:{value:e,enumerable:!0})),e);var g=(e,r,t)=>new Promise((a,i)=>{var n=l=>{try{u(t.next(l))}catch(c){i(c)}},o=l=>{try{u(t.throw(l))}catch(c){i(c)}},u=l=>l.done?a(l.value):Promise.resolve(l.value).then(n,o);u((t=t.apply(e,r)).next())});var ye=s((Th,Ve)=>{function ds(e,r){for(var t=-1,a=r.length,i=e.length;++t<a;)e[i+t]=r[t];return e}Ve.exports=ds});var ve=s((Ah,$e)=>{var hs=typeof global=="object"&&global&&global.Object===Object&&global;$e.exports=hs});var q=s((Sh,We)=>{var gs=ve(),ys=typeof self=="object"&&self&&self.Object===Object&&self,vs=gs||ys||Function("return this")();We.exports=vs});var E=s((Oh,Xe)=>{var _s=q(),ms=_s.Symbol;Xe.exports=ms});var Qe=s((Ph,Je)=>{var Ye=E(),Ze=Object.prototype,bs=Ze.hasOwnProperty,qs=Ze.toString,H=Ye?Ye.toStringTag:void 0;function xs(e){var r=bs.call(e,H),t=e[H];try{e[H]=void 0;var a=!0}catch(n){}var i=qs.call(e);return a&&(r?e[H]=t:delete e[H]),i}Je.exports=xs});var rr=s((Eh,er)=>{var Cs=Object.prototype,ws=Cs.toString;function Ts(e){return ws.call(e)}er.exports=Ts});var F=s((Fh,nr)=>{var tr=E(),As=Qe(),Ss=rr(),Os="[object Null]",Ps="[object Undefined]",ar=tr?tr.toStringTag:void 0;function Es(e){return e==null?e===void 0?Ps:Os:ar&&ar in Object(e)?As(e):Ss(e)}nr.exports=Es});var M=s((Mh,ir)=>{function Fs(e){return e!=null&&typeof e=="object"}ir.exports=Fs});var or=s((Lh,sr)=>{var Ms=F(),Ls=M(),Is="[object Arguments]";function Ds(e){return Ls(e)&&Ms(e)==Is}sr.exports=Ds});var ie=s((Ih,cr)=>{var ur=or(),Rs=M(),lr=Object.prototype,Ns=lr.hasOwnProperty,Bs=lr.propertyIsEnumerable,Gs=ur(function(){return arguments}())?ur:function(e){return Rs(e)&&Ns.call(e,"callee")&&!Bs.call(e,"callee")};cr.exports=Gs});var b=s((Dh,pr)=>{var js=Array.isArray;pr.exports=js});var gr=s((Rh,hr)=>{var fr=E(),ks=ie(),Hs=b(),dr=fr?fr.isConcatSpreadable:void 0;function Ks(e){return Hs(e)||ks(e)||!!(dr&&e&&e[dr])}hr.exports=Ks});var _r=s((Nh,vr)=>{var Us=ye(),zs=gr();function yr(e,r,t,a,i){var n=-1,o=e.length;for(t||(t=zs),i||(i=[]);++n<o;){var u=e[n];r>0&&t(u)?r>1?yr(u,r-1,t,a,i):Us(i,u):a||(i[i.length]=u)}return i}vr.exports=yr});var _e=s((Bh,mr)=>{function Vs(e,r){for(var t=-1,a=e==null?0:e.length,i=Array(a);++t<a;)i[t]=r(e[t],t,e);return i}mr.exports=Vs});var K=s((Gh,br)=>{var $s=F(),Ws=M(),Xs="[object Symbol]";function Ys(e){return typeof e=="symbol"||Ws(e)&&$s(e)==Xs}br.exports=Ys});var se=s((jh,qr)=>{var Zs=b(),Js=K(),Qs=/\.|\[(?:[^[\]]*|(["'])(?:(?!\1)[^\\]|\\.)*?\1)\]/,eo=/^\w*$/;function ro(e,r){if(Zs(e))return!1;var t=typeof e;return t=="number"||t=="symbol"||t=="boolean"||e==null||Js(e)?!0:eo.test(e)||!Qs.test(e)||r!=null&&e in Object(r)}qr.exports=ro});var U=s((kh,xr)=>{function to(e){var r=typeof e;return e!=null&&(r=="object"||r=="function")}xr.exports=to});var me=s((Hh,Cr)=>{var ao=F(),no=U(),io="[object AsyncFunction]",so="[object Function]",oo="[object GeneratorFunction]",uo="[object Proxy]";function lo(e){if(!no(e))return!1;var r=ao(e);return r==so||r==oo||r==io||r==uo}Cr.exports=lo});var Tr=s((Kh,wr)=>{var co=q(),po=co["__core-js_shared__"];wr.exports=po});var Or=s((Uh,Sr)=>{var be=Tr(),Ar=function(){var e=/[^.]+$/.exec(be&&be.keys&&be.keys.IE_PROTO||"");return e?"Symbol(src)_1."+e:""}();function fo(e){return!!Ar&&Ar in e}Sr.exports=fo});var qe=s((zh,Pr)=>{var ho=Function.prototype,go=ho.toString;function yo(e){if(e!=null){try{return go.call(e)}catch(r){}try{return e+""}catch(r){}}return""}Pr.exports=yo});var Fr=s((Vh,Er)=>{var vo=me(),_o=Or(),mo=U(),bo=qe(),qo=/[\\^$.*+?()[\]{}|]/g,xo=/^\[object .+?Constructor\]$/,Co=Function.prototype,wo=Object.prototype,To=Co.toString,Ao=wo.hasOwnProperty,So=RegExp("^"+To.call(Ao).replace(qo,"\\$&").replace(/hasOwnProperty|(function).*?(?=\\\()| for .+?(?=\\\])/g,"$1.*?")+"$");function Oo(e){if(!mo(e)||_o(e))return!1;var r=vo(e)?So:xo;return r.test(bo(e))}Er.exports=Oo});var Lr=s(($h,Mr)=>{function Po(e,r){return e==null?void 0:e[r]}Mr.exports=Po});var T=s((Wh,Ir)=>{var Eo=Fr(),Fo=Lr();function Mo(e,r){var t=Fo(e,r);return Eo(t)?t:void 0}Ir.exports=Mo});var z=s((Xh,Dr)=>{var Lo=T(),Io=Lo(Object,"create");Dr.exports=Io});var Br=s((Yh,Nr)=>{var Rr=z();function Do(){this.__data__=Rr?Rr(null):{},this.size=0}Nr.exports=Do});var jr=s((Zh,Gr)=>{function Ro(e){var r=this.has(e)&&delete this.__data__[e];return this.size-=r?1:0,r}Gr.exports=Ro});var Hr=s((Jh,kr)=>{var No=z(),Bo="__lodash_hash_undefined__",Go=Object.prototype,jo=Go.hasOwnProperty;function ko(e){var r=this.__data__;if(No){var t=r[e];return t===Bo?void 0:t}return jo.call(r,e)?r[e]:void 0}kr.exports=ko});var Ur=s((Qh,Kr)=>{var Ho=z(),Ko=Object.prototype,Uo=Ko.hasOwnProperty;function zo(e){var r=this.__data__;return Ho?r[e]!==void 0:Uo.call(r,e)}Kr.exports=zo});var Vr=s((eg,zr)=>{var Vo=z(),$o="__lodash_hash_undefined__";function Wo(e,r){var t=this.__data__;return this.size+=this.has(e)?0:1,t[e]=Vo&&r===void 0?$o:r,this}zr.exports=Wo});var Wr=s((rg,$r)=>{var Xo=Br(),Yo=jr(),Zo=Hr(),Jo=Ur(),Qo=Vr();function L(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var a=e[r];this.set(a[0],a[1])}}L.prototype.clear=Xo;L.prototype.delete=Yo;L.prototype.get=Zo;L.prototype.has=Jo;L.prototype.set=Qo;$r.exports=L});var Yr=s((tg,Xr)=>{function eu(){this.__data__=[],this.size=0}Xr.exports=eu});var oe=s((ag,Zr)=>{function ru(e,r){return e===r||e!==e&&r!==r}Zr.exports=ru});var V=s((ng,Jr)=>{var tu=oe();function au(e,r){for(var t=e.length;t--;)if(tu(e[t][0],r))return t;return-1}Jr.exports=au});var et=s((ig,Qr)=>{var nu=V(),iu=Array.prototype,su=iu.splice;function ou(e){var r=this.__data__,t=nu(r,e);if(t<0)return!1;var a=r.length-1;return t==a?r.pop():su.call(r,t,1),--this.size,!0}Qr.exports=ou});var tt=s((sg,rt)=>{var uu=V();function lu(e){var r=this.__data__,t=uu(r,e);return t<0?void 0:r[t][1]}rt.exports=lu});var nt=s((og,at)=>{var cu=V();function pu(e){return cu(this.__data__,e)>-1}at.exports=pu});var st=s((ug,it)=>{var fu=V();function du(e,r){var t=this.__data__,a=fu(t,e);return a<0?(++this.size,t.push([e,r])):t[a][1]=r,this}it.exports=du});var $=s((lg,ot)=>{var hu=Yr(),gu=et(),yu=tt(),vu=nt(),_u=st();function I(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var a=e[r];this.set(a[0],a[1])}}I.prototype.clear=hu;I.prototype.delete=gu;I.prototype.get=yu;I.prototype.has=vu;I.prototype.set=_u;ot.exports=I});var ue=s((cg,ut)=>{var mu=T(),bu=q(),qu=mu(bu,"Map");ut.exports=qu});var pt=s((pg,ct)=>{var lt=Wr(),xu=$(),Cu=ue();function wu(){this.size=0,this.__data__={hash:new lt,map:new(Cu||xu),string:new lt}}ct.exports=wu});var dt=s((fg,ft)=>{function Tu(e){var r=typeof e;return r=="string"||r=="number"||r=="symbol"||r=="boolean"?e!=="__proto__":e===null}ft.exports=Tu});var W=s((dg,ht)=>{var Au=dt();function Su(e,r){var t=e.__data__;return Au(r)?t[typeof r=="string"?"string":"hash"]:t.map}ht.exports=Su});var yt=s((hg,gt)=>{var Ou=W();function Pu(e){var r=Ou(this,e).delete(e);return this.size-=r?1:0,r}gt.exports=Pu});var _t=s((gg,vt)=>{var Eu=W();function Fu(e){return Eu(this,e).get(e)}vt.exports=Fu});var bt=s((yg,mt)=>{var Mu=W();function Lu(e){return Mu(this,e).has(e)}mt.exports=Lu});var xt=s((vg,qt)=>{var Iu=W();function Du(e,r){var t=Iu(this,e),a=t.size;return t.set(e,r),this.size+=t.size==a?0:1,this}qt.exports=Du});var le=s((_g,Ct)=>{var Ru=pt(),Nu=yt(),Bu=_t(),Gu=bt(),ju=xt();function D(e){var r=-1,t=e==null?0:e.length;for(this.clear();++r<t;){var a=e[r];this.set(a[0],a[1])}}D.prototype.clear=Ru;D.prototype.delete=Nu;D.prototype.get=Bu;D.prototype.has=Gu;D.prototype.set=ju;Ct.exports=D});var At=s((mg,Tt)=>{var wt=le(),ku="Expected a function";function xe(e,r){if(typeof e!="function"||r!=null&&typeof r!="function")throw new TypeError(ku);var t=function(){var a=arguments,i=r?r.apply(this,a):a[0],n=t.cache;if(n.has(i))return n.get(i);var o=e.apply(this,a);return t.cache=n.set(i,o)||n,o};return t.cache=new(xe.Cache||wt),t}xe.Cache=wt;Tt.exports=xe});var Ot=s((bg,St)=>{var Hu=At(),Ku=500;function Uu(e){var r=Hu(e,function(a){return t.size===Ku&&t.clear(),a}),t=r.cache;return r}St.exports=Uu});var Et=s((qg,Pt)=>{var zu=Ot(),Vu=/[^.[\]]+|\[(?:(-?\d+(?:\.\d+)?)|(["'])((?:(?!\2)[^\\]|\\.)*?)\2)\]|(?=(?:\.|\[\])(?:\.|\[\]|$))/g,$u=/\\(\\)?/g,Wu=zu(function(e){var r=[];return e.charCodeAt(0)===46&&r.push(""),e.replace(Vu,function(t,a,i,n){r.push(i?n.replace($u,"$1"):a||t)}),r});Pt.exports=Wu});var Rt=s((xg,Dt)=>{var Ft=E(),Xu=_e(),Yu=b(),Zu=K(),Ju=1/0,Mt=Ft?Ft.prototype:void 0,Lt=Mt?Mt.toString:void 0;function It(e){if(typeof e=="string")return e;if(Yu(e))return Xu(e,It)+"";if(Zu(e))return Lt?Lt.call(e):"";var r=e+"";return r=="0"&&1/e==-Ju?"-0":r}Dt.exports=It});var Bt=s((Cg,Nt)=>{var Qu=Rt();function el(e){return e==null?"":Qu(e)}Nt.exports=el});var Ce=s((wg,Gt)=>{var rl=b(),tl=se(),al=Et(),nl=Bt();function il(e,r){return rl(e)?e:tl(e,r)?[e]:al(nl(e))}Gt.exports=il});var X=s((Tg,jt)=>{var sl=K(),ol=1/0;function ul(e){if(typeof e=="string"||sl(e))return e;var r=e+"";return r=="0"&&1/e==-ol?"-0":r}jt.exports=ul});var ce=s((Ag,kt)=>{var ll=Ce(),cl=X();function pl(e,r){r=ll(r,e);for(var t=0,a=r.length;e!=null&&t<a;)e=e[cl(r[t++])];return t&&t==a?e:void 0}kt.exports=pl});var Kt=s((Sg,Ht)=>{var fl=$();function dl(){this.__data__=new fl,this.size=0}Ht.exports=dl});var zt=s((Og,Ut)=>{function hl(e){var r=this.__data__,t=r.delete(e);return this.size=r.size,t}Ut.exports=hl});var $t=s((Pg,Vt)=>{function gl(e){return this.__data__.get(e)}Vt.exports=gl});var Xt=s((Eg,Wt)=>{function yl(e){return this.__data__.has(e)}Wt.exports=yl});var Zt=s((Fg,Yt)=>{var vl=$(),_l=ue(),ml=le(),bl=200;function ql(e,r){var t=this.__data__;if(t instanceof vl){var a=t.__data__;if(!_l||a.length<bl-1)return a.push([e,r]),this.size=++t.size,this;t=this.__data__=new ml(a)}return t.set(e,r),this.size=t.size,this}Yt.exports=ql});var we=s((Mg,Jt)=>{var xl=$(),Cl=Kt(),wl=zt(),Tl=$t(),Al=Xt(),Sl=Zt();function R(e){var r=this.__data__=new xl(e);this.size=r.size}R.prototype.clear=Cl;R.prototype.delete=wl;R.prototype.get=Tl;R.prototype.has=Al;R.prototype.set=Sl;Jt.exports=R});var ea=s((Lg,Qt)=>{var Ol="__lodash_hash_undefined__";function Pl(e){return this.__data__.set(e,Ol),this}Qt.exports=Pl});var ta=s((Ig,ra)=>{function El(e){return this.__data__.has(e)}ra.exports=El});var na=s((Dg,aa)=>{var Fl=le(),Ml=ea(),Ll=ta();function pe(e){var r=-1,t=e==null?0:e.length;for(this.__data__=new Fl;++r<t;)this.add(e[r])}pe.prototype.add=pe.prototype.push=Ml;pe.prototype.has=Ll;aa.exports=pe});var sa=s((Rg,ia)=>{function Il(e,r){for(var t=-1,a=e==null?0:e.length;++t<a;)if(r(e[t],t,e))return!0;return!1}ia.exports=Il});var ua=s((Ng,oa)=>{function Dl(e,r){return e.has(r)}oa.exports=Dl});var Te=s((Bg,la)=>{var Rl=na(),Nl=sa(),Bl=ua(),Gl=1,jl=2;function kl(e,r,t,a,i,n){var o=t&Gl,u=e.length,l=r.length;if(u!=l&&!(o&&l>u))return!1;var c=n.get(e),f=n.get(r);if(c&&f)return c==r&&f==e;var d=-1,p=!0,y=t&jl?new Rl:void 0;for(n.set(e,r),n.set(r,e);++d<u;){var _=e[d],m=r[d];if(a)var w=o?a(m,_,d,r,e,n):a(_,m,d,e,r,n);if(w!==void 0){if(w)continue;p=!1;break}if(y){if(!Nl(r,function(A,S){if(!Bl(y,S)&&(_===A||i(_,A,t,a,n)))return y.push(S)})){p=!1;break}}else if(!(_===m||i(_,m,t,a,n))){p=!1;break}}return n.delete(e),n.delete(r),p}la.exports=kl});var pa=s((Gg,ca)=>{var Hl=q(),Kl=Hl.Uint8Array;ca.exports=Kl});var da=s((jg,fa)=>{function Ul(e){var r=-1,t=Array(e.size);return e.forEach(function(a,i){t[++r]=[i,a]}),t}fa.exports=Ul});var ga=s((kg,ha)=>{function zl(e){var r=-1,t=Array(e.size);return e.forEach(function(a){t[++r]=a}),t}ha.exports=zl});var ba=s((Hg,ma)=>{var ya=E(),va=pa(),Vl=oe(),$l=Te(),Wl=da(),Xl=ga(),Yl=1,Zl=2,Jl="[object Boolean]",Ql="[object Date]",ec="[object Error]",rc="[object Map]",tc="[object Number]",ac="[object RegExp]",nc="[object Set]",ic="[object String]",sc="[object Symbol]",oc="[object ArrayBuffer]",uc="[object DataView]",_a=ya?ya.prototype:void 0,Ae=_a?_a.valueOf:void 0;function lc(e,r,t,a,i,n,o){switch(t){case uc:if(e.byteLength!=r.byteLength||e.byteOffset!=r.byteOffset)return!1;e=e.buffer,r=r.buffer;case oc:return!(e.byteLength!=r.byteLength||!n(new va(e),new va(r)));case Jl:case Ql:case tc:return Vl(+e,+r);case ec:return e.name==r.name&&e.message==r.message;case ac:case ic:return e==r+"";case rc:var u=Wl;case nc:var l=a&Yl;if(u||(u=Xl),e.size!=r.size&&!l)return!1;var c=o.get(e);if(c)return c==r;a|=Zl,o.set(e,r);var f=$l(u(e),u(r),a,i,n,o);return o.delete(e),f;case sc:if(Ae)return Ae.call(e)==Ae.call(r)}return!1}ma.exports=lc});var xa=s((Kg,qa)=>{var cc=ye(),pc=b();function fc(e,r,t){var a=r(e);return pc(e)?a:cc(a,t(e))}qa.exports=fc});var wa=s((Ug,Ca)=>{function dc(e,r){for(var t=-1,a=e==null?0:e.length,i=0,n=[];++t<a;){var o=e[t];r(o,t,e)&&(n[i++]=o)}return n}Ca.exports=dc});var Aa=s((zg,Ta)=>{function hc(){return[]}Ta.exports=hc});var Pa=s((Vg,Oa)=>{var gc=wa(),yc=Aa(),vc=Object.prototype,_c=vc.propertyIsEnumerable,Sa=Object.getOwnPropertySymbols,mc=Sa?function(e){return e==null?[]:(e=Object(e),gc(Sa(e),function(r){return _c.call(e,r)}))}:yc;Oa.exports=mc});var Fa=s(($g,Ea)=>{function bc(e,r){for(var t=-1,a=Array(e);++t<e;)a[t]=r(t);return a}Ea.exports=bc});var La=s((Wg,Ma)=>{function qc(){return!1}Ma.exports=qc});var Se=s((Y,N)=>{var xc=q(),Cc=La(),Ia=typeof Y=="object"&&Y&&!Y.nodeType&&Y,Da=Ia&&typeof N=="object"&&N&&!N.nodeType&&N,wc=Da&&Da.exports===Ia,Ra=wc?xc.Buffer:void 0,Tc=Ra?Ra.isBuffer:void 0,Ac=Tc||Cc;N.exports=Ac});var fe=s((Xg,Na)=>{var Sc=9007199254740991,Oc=/^(?:0|[1-9]\d*)$/;function Pc(e,r){var t=typeof e;return r=r==null?Sc:r,!!r&&(t=="number"||t!="symbol"&&Oc.test(e))&&e>-1&&e%1==0&&e<r}Na.exports=Pc});var de=s((Yg,Ba)=>{var Ec=9007199254740991;function Fc(e){return typeof e=="number"&&e>-1&&e%1==0&&e<=Ec}Ba.exports=Fc});var ja=s((Zg,Ga)=>{var Mc=F(),Lc=de(),Ic=M(),Dc="[object Arguments]",Rc="[object Array]",Nc="[object Boolean]",Bc="[object Date]",Gc="[object Error]",jc="[object Function]",kc="[object Map]",Hc="[object Number]",Kc="[object Object]",Uc="[object RegExp]",zc="[object Set]",Vc="[object String]",$c="[object WeakMap]",Wc="[object ArrayBuffer]",Xc="[object DataView]",Yc="[object Float32Array]",Zc="[object Float64Array]",Jc="[object Int8Array]",Qc="[object Int16Array]",ep="[object Int32Array]",rp="[object Uint8Array]",tp="[object Uint8ClampedArray]",ap="[object Uint16Array]",np="[object Uint32Array]",h={};h[Yc]=h[Zc]=h[Jc]=h[Qc]=h[ep]=h[rp]=h[tp]=h[ap]=h[np]=!0;h[Dc]=h[Rc]=h[Wc]=h[Nc]=h[Xc]=h[Bc]=h[Gc]=h[jc]=h[kc]=h[Hc]=h[Kc]=h[Uc]=h[zc]=h[Vc]=h[$c]=!1;function ip(e){return Ic(e)&&Lc(e.length)&&!!h[Mc(e)]}Ga.exports=ip});var Oe=s((Jg,ka)=>{function sp(e){return function(r){return e(r)}}ka.exports=sp});var Ka=s((J,B)=>{var op=ve(),Ha=typeof J=="object"&&J&&!J.nodeType&&J,Z=Ha&&typeof B=="object"&&B&&!B.nodeType&&B,up=Z&&Z.exports===Ha,Pe=up&&op.process,lp=function(){try{var e=Z&&Z.require&&Z.require("util").types;return e||Pe&&Pe.binding&&Pe.binding("util")}catch(r){}}();B.exports=lp});var Ee=s((Qg,Va)=>{var cp=ja(),pp=Oe(),Ua=Ka(),za=Ua&&Ua.isTypedArray,fp=za?pp(za):cp;Va.exports=fp});var Wa=s((ey,$a)=>{var dp=Fa(),hp=ie(),gp=b(),yp=Se(),vp=fe(),_p=Ee(),mp=Object.prototype,bp=mp.hasOwnProperty;function qp(e,r){var t=gp(e),a=!t&&hp(e),i=!t&&!a&&yp(e),n=!t&&!a&&!i&&_p(e),o=t||a||i||n,u=o?dp(e.length,String):[],l=u.length;for(var c in e)(r||bp.call(e,c))&&!(o&&(c=="length"||i&&(c=="offset"||c=="parent")||n&&(c=="buffer"||c=="byteLength"||c=="byteOffset")||vp(c,l)))&&u.push(c);return u}$a.exports=qp});var Ya=s((ry,Xa)=>{var xp=Object.prototype;function Cp(e){var r=e&&e.constructor,t=typeof r=="function"&&r.prototype||xp;return e===t}Xa.exports=Cp});var Ja=s((ty,Za)=>{function wp(e,r){return function(t){return e(r(t))}}Za.exports=wp});var en=s((ay,Qa)=>{var Tp=Ja(),Ap=Tp(Object.keys,Object);Qa.exports=Ap});var tn=s((ny,rn)=>{var Sp=Ya(),Op=en(),Pp=Object.prototype,Ep=Pp.hasOwnProperty;function Fp(e){if(!Sp(e))return Op(e);var r=[];for(var t in Object(e))Ep.call(e,t)&&t!="constructor"&&r.push(t);return r}rn.exports=Fp});var Q=s((iy,an)=>{var Mp=me(),Lp=de();function Ip(e){return e!=null&&Lp(e.length)&&!Mp(e)}an.exports=Ip});var he=s((sy,nn)=>{var Dp=Wa(),Rp=tn(),Np=Q();function Bp(e){return Np(e)?Dp(e):Rp(e)}nn.exports=Bp});var on=s((oy,sn)=>{var Gp=xa(),jp=Pa(),kp=he();function Hp(e){return Gp(e,kp,jp)}sn.exports=Hp});var cn=s((uy,ln)=>{var un=on(),Kp=1,Up=Object.prototype,zp=Up.hasOwnProperty;function Vp(e,r,t,a,i,n){var o=t&Kp,u=un(e),l=u.length,c=un(r),f=c.length;if(l!=f&&!o)return!1;for(var d=l;d--;){var p=u[d];if(!(o?p in r:zp.call(r,p)))return!1}var y=n.get(e),_=n.get(r);if(y&&_)return y==r&&_==e;var m=!0;n.set(e,r),n.set(r,e);for(var w=o;++d<l;){p=u[d];var A=e[p],S=r[p];if(a)var Ue=o?a(S,A,p,r,e,n):a(A,S,p,e,r,n);if(!(Ue===void 0?A===S||i(A,S,t,a,n):Ue)){m=!1;break}w||(w=p=="constructor")}if(m&&!w){var te=e.constructor,ae=r.constructor;te!=ae&&"constructor"in e&&"constructor"in r&&!(typeof te=="function"&&te instanceof te&&typeof ae=="function"&&ae instanceof ae)&&(m=!1)}return n.delete(e),n.delete(r),m}ln.exports=Vp});var fn=s((ly,pn)=>{var $p=T(),Wp=q(),Xp=$p(Wp,"DataView");pn.exports=Xp});var hn=s((cy,dn)=>{var Yp=T(),Zp=q(),Jp=Yp(Zp,"Promise");dn.exports=Jp});var yn=s((py,gn)=>{var Qp=T(),ef=q(),rf=Qp(ef,"Set");gn.exports=rf});var _n=s((fy,vn)=>{var tf=T(),af=q(),nf=tf(af,"WeakMap");vn.exports=nf});var An=s((dy,Tn)=>{var Fe=fn(),Me=ue(),Le=hn(),Ie=yn(),De=_n(),mn=F(),G=qe(),bn="[object Map]",sf="[object Object]",qn="[object Promise]",xn="[object Set]",Cn="[object WeakMap]",wn="[object DataView]",of=G(Fe),uf=G(Me),lf=G(Le),cf=G(Ie),pf=G(De),O=mn;(Fe&&O(new Fe(new ArrayBuffer(1)))!=wn||Me&&O(new Me)!=bn||Le&&O(Le.resolve())!=qn||Ie&&O(new Ie)!=xn||De&&O(new De)!=Cn)&&(O=function(e){var r=mn(e),t=r==sf?e.constructor:void 0,a=t?G(t):"";if(a)switch(a){case of:return wn;case uf:return bn;case lf:return qn;case cf:return xn;case pf:return Cn}return r});Tn.exports=O});var In=s((hy,Ln)=>{var Re=we(),ff=Te(),df=ba(),hf=cn(),Sn=An(),On=b(),Pn=Se(),gf=Ee(),yf=1,En="[object Arguments]",Fn="[object Array]",ge="[object Object]",vf=Object.prototype,Mn=vf.hasOwnProperty;function _f(e,r,t,a,i,n){var o=On(e),u=On(r),l=o?Fn:Sn(e),c=u?Fn:Sn(r);l=l==En?ge:l,c=c==En?ge:c;var f=l==ge,d=c==ge,p=l==c;if(p&&Pn(e)){if(!Pn(r))return!1;o=!0,f=!1}if(p&&!f)return n||(n=new Re),o||gf(e)?ff(e,r,t,a,i,n):df(e,r,l,t,a,i,n);if(!(t&yf)){var y=f&&Mn.call(e,"__wrapped__"),_=d&&Mn.call(r,"__wrapped__");if(y||_){var m=y?e.value():e,w=_?r.value():r;return n||(n=new Re),i(m,w,t,a,n)}}return p?(n||(n=new Re),hf(e,r,t,a,i,n)):!1}Ln.exports=_f});var Ne=s((gy,Nn)=>{var mf=In(),Dn=M();function Rn(e,r,t,a,i){return e===r?!0:e==null||r==null||!Dn(e)&&!Dn(r)?e!==e&&r!==r:mf(e,r,t,a,Rn,i)}Nn.exports=Rn});var Gn=s((yy,Bn)=>{var bf=we(),qf=Ne(),xf=1,Cf=2;function wf(e,r,t,a){var i=t.length,n=i,o=!a;if(e==null)return!n;for(e=Object(e);i--;){var u=t[i];if(o&&u[2]?u[1]!==e[u[0]]:!(u[0]in e))return!1}for(;++i<n;){u=t[i];var l=u[0],c=e[l],f=u[1];if(o&&u[2]){if(c===void 0&&!(l in e))return!1}else{var d=new bf;if(a)var p=a(c,f,l,e,r,d);if(!(p===void 0?qf(f,c,xf|Cf,a,d):p))return!1}}return!0}Bn.exports=wf});var Be=s((vy,jn)=>{var Tf=U();function Af(e){return e===e&&!Tf(e)}jn.exports=Af});var Hn=s((_y,kn)=>{var Sf=Be(),Of=he();function Pf(e){for(var r=Of(e),t=r.length;t--;){var a=r[t],i=e[a];r[t]=[a,i,Sf(i)]}return r}kn.exports=Pf});var Ge=s((my,Kn)=>{function Ef(e,r){return function(t){return t==null?!1:t[e]===r&&(r!==void 0||e in Object(t))}}Kn.exports=Ef});var zn=s((by,Un)=>{var Ff=Gn(),Mf=Hn(),Lf=Ge();function If(e){var r=Mf(e);return r.length==1&&r[0][2]?Lf(r[0][0],r[0][1]):function(t){return t===e||Ff(t,e,r)}}Un.exports=If});var $n=s((qy,Vn)=>{var Df=ce();function Rf(e,r,t){var a=e==null?void 0:Df(e,r);return a===void 0?t:a}Vn.exports=Rf});var Xn=s((xy,Wn)=>{function Nf(e,r){return e!=null&&r in Object(e)}Wn.exports=Nf});var Zn=s((Cy,Yn)=>{var Bf=Ce(),Gf=ie(),jf=b(),kf=fe(),Hf=de(),Kf=X();function Uf(e,r,t){r=Bf(r,e);for(var a=-1,i=r.length,n=!1;++a<i;){var o=Kf(r[a]);if(!(n=e!=null&&t(e,o)))break;e=e[o]}return n||++a!=i?n:(i=e==null?0:e.length,!!i&&Hf(i)&&kf(o,i)&&(jf(e)||Gf(e)))}Yn.exports=Uf});var Qn=s((wy,Jn)=>{var zf=Xn(),Vf=Zn();function $f(e,r){return e!=null&&Vf(e,r,zf)}Jn.exports=$f});var ri=s((Ty,ei)=>{var Wf=Ne(),Xf=$n(),Yf=Qn(),Zf=se(),Jf=Be(),Qf=Ge(),ed=X(),rd=1,td=2;function ad(e,r){return Zf(e)&&Jf(r)?Qf(ed(e),r):function(t){var a=Xf(t,e);return a===void 0&&a===r?Yf(t,e):Wf(r,a,rd|td)}}ei.exports=ad});var ee=s((Ay,ti)=>{function nd(e){return e}ti.exports=nd});var ni=s((Sy,ai)=>{function id(e){return function(r){return r==null?void 0:r[e]}}ai.exports=id});var si=s((Oy,ii)=>{var sd=ce();function od(e){return function(r){return sd(r,e)}}ii.exports=od});var ui=s((Py,oi)=>{var ud=ni(),ld=si(),cd=se(),pd=X();function fd(e){return cd(e)?ud(pd(e)):ld(e)}oi.exports=fd});var ci=s((Ey,li)=>{var dd=zn(),hd=ri(),gd=ee(),yd=b(),vd=ui();function _d(e){return typeof e=="function"?e:e==null?gd:typeof e=="object"?yd(e)?hd(e[0],e[1]):dd(e):vd(e)}li.exports=_d});var fi=s((Fy,pi)=>{function md(e){return function(r,t,a){for(var i=-1,n=Object(r),o=a(r),u=o.length;u--;){var l=o[e?u:++i];if(t(n[l],l,n)===!1)break}return r}}pi.exports=md});var hi=s((My,di)=>{var bd=fi(),qd=bd();di.exports=qd});var yi=s((Ly,gi)=>{var xd=hi(),Cd=he();function wd(e,r){return e&&xd(e,r,Cd)}gi.exports=wd});var _i=s((Iy,vi)=>{var Td=Q();function Ad(e,r){return function(t,a){if(t==null)return t;if(!Td(t))return e(t,a);for(var i=t.length,n=r?i:-1,o=Object(t);(r?n--:++n<i)&&a(o[n],n,o)!==!1;);return t}}vi.exports=Ad});var bi=s((Dy,mi)=>{var Sd=yi(),Od=_i(),Pd=Od(Sd);mi.exports=Pd});var xi=s((Ry,qi)=>{var Ed=bi(),Fd=Q();function Md(e,r){var t=-1,a=Fd(e)?Array(e.length):[];return Ed(e,function(i,n,o){a[++t]=r(i,n,o)}),a}qi.exports=Md});var wi=s((Ny,Ci)=>{function Ld(e,r){var t=e.length;for(e.sort(r);t--;)e[t]=e[t].value;return e}Ci.exports=Ld});var Si=s((By,Ai)=>{var Ti=K();function Id(e,r){if(e!==r){var t=e!==void 0,a=e===null,i=e===e,n=Ti(e),o=r!==void 0,u=r===null,l=r===r,c=Ti(r);if(!u&&!c&&!n&&e>r||n&&o&&l&&!u&&!c||a&&o&&l||!t&&l||!i)return 1;if(!a&&!n&&!c&&e<r||c&&t&&i&&!a&&!n||u&&t&&i||!o&&i||!l)return-1}return 0}Ai.exports=Id});var Pi=s((Gy,Oi)=>{var Dd=Si();function Rd(e,r,t){for(var a=-1,i=e.criteria,n=r.criteria,o=i.length,u=t.length;++a<o;){var l=Dd(i[a],n[a]);if(l){if(a>=u)return l;var c=t[a];return l*(c=="desc"?-1:1)}}return e.index-r.index}Oi.exports=Rd});var Fi=s((jy,Ei)=>{var je=_e(),Nd=ce(),Bd=ci(),Gd=xi(),jd=wi(),kd=Oe(),Hd=Pi(),Kd=ee(),Ud=b();function zd(e,r,t){r.length?r=je(r,function(n){return Ud(n)?function(o){return Nd(o,n.length===1?n[0]:n)}:n}):r=[Kd];var a=-1;r=je(r,kd(Bd));var i=Gd(e,function(n,o,u){var l=je(r,function(c){return c(n)});return{criteria:l,index:++a,value:n}});return jd(i,function(n,o){return Hd(n,o,t)})}Ei.exports=zd});var Li=s((ky,Mi)=>{function Vd(e,r,t){switch(t.length){case 0:return e.call(r);case 1:return e.call(r,t[0]);case 2:return e.call(r,t[0],t[1]);case 3:return e.call(r,t[0],t[1],t[2])}return e.apply(r,t)}Mi.exports=Vd});var Ri=s((Hy,Di)=>{var $d=Li(),Ii=Math.max;function Wd(e,r,t){return r=Ii(r===void 0?e.length-1:r,0),function(){for(var a=arguments,i=-1,n=Ii(a.length-r,0),o=Array(n);++i<n;)o[i]=a[r+i];i=-1;for(var u=Array(r+1);++i<r;)u[i]=a[i];return u[r]=t(o),$d(e,this,u)}}Di.exports=Wd});var Bi=s((Ky,Ni)=>{function Xd(e){return function(){return e}}Ni.exports=Xd});var ji=s((Uy,Gi)=>{var Yd=T(),Zd=function(){try{var e=Yd(Object,"defineProperty");return e({},"",{}),e}catch(r){}}();Gi.exports=Zd});var Ki=s((zy,Hi)=>{var Jd=Bi(),ki=ji(),Qd=ee(),eh=ki?function(e,r){return ki(e,"toString",{configurable:!0,enumerable:!1,value:Jd(r),writable:!0})}:Qd;Hi.exports=eh});var zi=s((Vy,Ui)=>{var rh=800,th=16,ah=Date.now;function nh(e){var r=0,t=0;return function(){var a=ah(),i=th-(a-t);if(t=a,i>0){if(++r>=rh)return arguments[0]}else r=0;return e.apply(void 0,arguments)}}Ui.exports=nh});var $i=s(($y,Vi)=>{var ih=Ki(),sh=zi(),oh=sh(ih);Vi.exports=oh});var Xi=s((Wy,Wi)=>{var uh=ee(),lh=Ri(),ch=$i();function ph(e,r){return ch(lh(e,r,uh),e+"")}Wi.exports=ph});var Zi=s((Xy,Yi)=>{var fh=oe(),dh=Q(),hh=fe(),gh=U();function yh(e,r,t){if(!gh(t))return!1;var a=typeof r;return(a=="number"?dh(t)&&hh(r,t.length):a=="string"&&r in t)?fh(t[r],e):!1}Yi.exports=yh});var es=s((Yy,Qi)=>{var vh=_r(),_h=Fi(),mh=Xi(),Ji=Zi(),bh=mh(function(e,r){if(e==null)return[];var t=r.length;return t>1&&Ji(e,r[0],r[1])?r=[]:t>2&&Ji(r[0],r[1],r[2])&&(r=[r[0]]),_h(e,vh(r,1),[])});Qi.exports=bh});ps(exports,{default:()=>Ke});var ns=P(es()),C=P(require("obsidian")),is=P(require("@codemirror/language"));function ke(e,r){let t=Object.keys(r).map(a=>qh(e,a,r[a]));return t.length===1?t[0]:function(){t.forEach(a=>a())}}function qh(e,r,t){let a=e[r],i=e.hasOwnProperty(r),n=t(a);return a&&Object.setPrototypeOf(n,a),Object.setPrototypeOf(o,n),e[r]=o,u;function o(...l){return n===a&&e[r]===o&&u(),n.apply(this,l)}function u(){e[r]===o&&(i?e[r]=a:delete e[r]),n!==a&&(n=a,Object.setPrototypeOf(o,a||Function))}}var v=P(require("@codemirror/view")),j=P(require("obsidian")),rs=class extends v.WidgetType{constructor(r,t,a,i){super();this.app=r;this.view=t;this.from=a;this.to=i}eq(r){return r.view===this.view&&r.from===this.from&&r.to===this.to}toDOM(){let r=createSpan("cm-creases-icon");return(0,j.setIcon)(r,"shirt"),r.addEventListener("click",t=>{new j.Menu().addItem(i=>i.setTitle("Remove crease").setIcon("x").onClick(()=>{this.view.dispatch({changes:{from:this.from,to:this.to,insert:""}})})).showAtMouseEvent(t)}),r}ignoreEvent(){return!1}};function ts(e){return v.ViewPlugin.fromClass(class{constructor(r){this.view=r;this.decorations=v.Decoration.none;this.allDecos=v.Decoration.none;this.decorator=new v.MatchDecorator({regexp:/\B%%\s+fold\s+%%\B/g,decoration:this.getDeco.bind(this)}),this.decorations=this.decorator.createDeco(r)}getDeco(r,t,a){let i=a,n=a+r[0].length;return v.Decoration.replace({widget:new rs(e,this.view,i,n)})}update(r){if(!r.state.field(j.editorLivePreviewField)){this.decorations=v.Decoration.none;return}this.decorations=this.decorator.updateDeco(r,this.decorations)}},{decorations:r=>r.decorations,provide:r=>v.EditorView.atomicRanges.of(t=>{var a;return((a=t.plugin(r))==null?void 0:a.decorations)||v.Decoration.none})})}var k=/%% +fold +%%/;function x(e){return k.test(e)}var re=P(require("obsidian")),as={onOpenCreasesBehavior:"preserve-fold-state",templateCreasesBehavior:"start-folded",syncOutlineView:"from-editor-to-outline"},He=class extends re.PluginSettingTab{constructor(r,t){super(r,t);this.plugin=t}display(){let{containerEl:r}=this;r.empty(),r.createEl("h3",{text:"Crease Behavior"}),new re.Setting(r).setName("How should creases behave when opening a new file?").setDesc("By default, creases will not override what content you have folded in your file. You can change this so that creases always start folded.").addDropdown(t=>{t.addOptions({"always-fold":"Always fold creases","preserve-fold-state":"Respect existing fold state"}),t.setValue(this.plugin.settings.onOpenCreasesBehavior),t.onChange(a=>g(this,null,function*(){this.plugin.settings.onOpenCreasesBehavior=a,yield this.plugin.saveSettings()}))}),new re.Setting(r).setName("How should creases in templates behave?").setDesc("When creating a new file with creases in the template, do you want the creases to start folded or unfolded? Choose 'fold and clear' to have the creases folded and removed from the newly created note.").addDropdown(t=>{t.addOptions({"start-folded":"Start folded","start-unfolded":"Start unfolded","fold-and-clear":"Fold them and clear the creases"}),t.setValue(this.plugin.settings.templateCreasesBehavior),t.onChange(a=>g(this,null,function*(){this.plugin.settings.templateCreasesBehavior=a,yield this.plugin.saveSettings()}))})}};var xh=[1,2,3,4,5,6],Ch=/\^([a-zA-Z0-9-]+)$/,Ke=class extends C.Plugin{onload(){return g(this,null,function*(){yield this.loadSettings(),this.registerSettingsTab(),this.registerEditorExtension(ts(this.app)),this.addCommand({id:"fold",name:"Fold along creases",checkCallback:r=>{let t=this.app.workspace.getActiveViewOfType(C.MarkdownView);if(r)return!!t;t&&this.foldCreasesForView(t)}}),this.addCommand({id:"toggle-crease",name:"Toggle crease",editorCallback:this.toggleCrease.bind(this)}),this.addCommand({id:"crease-current-folds",name:"Crease the current folds",editorCallback:this.creaseCurrentFolds.bind(this)}),this.addCommand({id:"clear-creases",name:"Iron out (clear) the creases",editorCallback:this.clearCreases.bind(this)}),this.addCommand({id:"increase-fold-level",name:"Increase heading fold level",editorCallback:this.increaseHeadingFoldLevel.bind(this)}),this.addCommand({id:"decrease-fold-level",name:"Decrease heading fold level",editorCallback:this.decreaseHeadingFoldLevel.bind(this)}),this.app.workspace.onLayoutReady(()=>{this.registerEvent(this.app.vault.on("create",this.onNewFile.bind(this))),this.patchCoreTemplatePlugin()}),xh.forEach(r=>{this.addCommand({id:`toggle-fold-heading-level-${r}`,name:`Toggle fold for H${r}`,checkCallback:t=>{var i,n;let a=this.app.workspace.getActiveViewOfType(C.MarkdownView);if(!a)return!1;if(t)return((n=(i=this.app.metadataCache.getFileCache(a.file))==null?void 0:i.headings)!=null?n:[]).find(u=>u.level===r)!==void 0;this.toggleFoldForHeadingLevel(a,r)}})}),this.onFileOpenListener=this.app.workspace.on("file-open",this.onFileOpen,this),this.registerEvent(this.onFileOpenListener),this.registerEvent(this.app.workspace.on("editor-menu",this.onEditorMenu,this)),this.registerEvent(this.app.workspace.on("templater:overwrite-file",this.onTemplaterNewFile,this)),this.registerEvent(this.app.workspace.on("templater:new-note-from-template",this.onTemplaterNewFile,this)),this.registerEvent(this.app.workspace.on("templater:template-appended",this.onTemplateAppend,this)),this.registerEvent(this.app.workspace.on("templates:template-appended",this.onTemplateAppend,this))})}onFileOpen(r){this.app.workspace.activeLeaf&&(this.patchMarkdownView(),this.app.workspace.offref(this.onFileOpenListener))}handleNewFile(r,t){return g(this,null,function*(){["start-folded","fold-and-clear"].contains(this.settings.templateCreasesBehavior)&&x(t)&&(this.foldCreasesForFile(r),this.settings.templateCreasesBehavior==="fold-and-clear"&&this.app.vault.modify(r,t.replace(new RegExp(k,"g"),"")))})}onNewFile(r){return g(this,null,function*(){if(!(r instanceof C.TFile))return;let t=yield this.app.vault.cachedRead(r);this.handleNewFile(r,t)})}onTemplaterNewFile(r){return g(this,null,function*(){let{file:t,contents:a}=r;this.handleNewFile(t,a)})}onTemplateAppend(r){return g(this,null,function*(){if(["start-folded","fold-and-clear"].contains(this.settings.templateCreasesBehavior)){let{view:t,newSelections:a,oldSelections:i}=r,n=[],o=[];for(let u=0;u<a.length;u++){let[l,,,c]=(0,ns.default)([i[u].anchor,i[u].head,a[u].anchor,a[u].head],["line","ch"]),f=t.editor.getRange(l,c);if(x(f))for(let d=l.line;d<=c.line;d++){let p=t.editor.getLine(d);if(x(p)&&n.push({from:d,to:d+1}),this.settings.templateCreasesBehavior==="fold-and-clear"){let y=p.replace(k,"").trimEnd();o.push({text:y,from:{line:d,ch:0},to:{line:d+1,ch:0}})}}}t.currentMode.applyFoldInfo({folds:n,lines:t.editor.lineCount()}),t.editor.transaction({changes:o})}})}decreaseHeadingFoldLevel(r,t){return g(this,null,function*(){var c,f,d;let a=t.currentMode.getFoldInfo(),i=(c=a==null?void 0:a.folds)!=null?c:[],n=(d=(f=this.app.metadataCache.getFileCache(t.file))==null?void 0:f.headings)!=null?d:[],o=1;for(let p of n)i.find(y=>y.from===p.position.start.line)||(o=Math.max(o,p.level));let u=n.filter(p=>p.level===o),l=[...i,...u.map(p=>({from:p.position.start.line,to:p.position.end.line}))];t.currentMode.applyFoldInfo({folds:l,lines:t.editor.lineCount()}),t.onMarkdownFold()})}increaseHeadingFoldLevel(r,t){return g(this,null,function*(){var c,f,d;let a=t.currentMode.getFoldInfo(),i=(c=a==null?void 0:a.folds)!=null?c:[],n=(d=(f=this.app.metadataCache.getFileCache(t.file))==null?void 0:f.headings)!=null?d:[],o=Math.max(...n.map(p=>p.level));for(let p of n)i.find(y=>y.from===p.position.start.line)&&(o=Math.min(o,p.level));let u=new Set(n.filter(p=>p.level<=o).map(p=>p.position.start.line)),l=i.filter(p=>!u.has(p.from));t.currentMode.applyFoldInfo({folds:l,lines:t.editor.lineCount()}),t.onMarkdownFold()})}patchMarkdownView(){let r=this,{workspace:t}=this.app,a=t.activeLeaf;!a||this.register(ke(a.view.constructor.prototype,{onLoadFile(i){return function(n){return g(this,null,function*(){yield i.call(this,n),n&&r.settings.onOpenCreasesBehavior==="always-fold"&&r.foldCreasesForFile(n)})}}}))}patchCoreTemplatePlugin(){let r=this.app.internalPlugins.getPluginById("templates");!r||this.register(ke(r.instance.constructor.prototype,{insertTemplate(t){return function(a){return g(this,null,function*(){let i=this.app.workspace.getActiveViewOfType(C.MarkdownView);if(!i)return;let n=i.editor.listSelections();yield t.call(this,a);let o=i.editor.listSelections();this.app.workspace.trigger("templates:template-appended",{content:this.app.vault.cachedRead(a),oldSelections:n,newSelections:o,view:i})})}}}))}getAllFoldableLines(r){if(this.app.vault.getConfig("legacyEditor")){let a=r.cm.state.foldGutter.options,i=r.cm.foldOption(a,"rangeFinder"),n=[];for(let o=0;o<=r.lastLine();o++){let u=i(r.cm,CodeMirror.Pos(o,0));u&&n.push({from:u.from.line,to:u.to.line})}return n}let t=[];for(let a=0;a<=r.lastLine();a++){let i=r.posToOffset({line:a,ch:0}),n=(0,is.foldable)(r.cm.state,i,i);if(n){let o=r.offsetToPos(n.from),u=r.offsetToPos(n.to);t.push({from:o.line,to:u.line})}}return t}getRelevantFold(r,t){let a=this.getAllFoldableLines(r);for(let i=a.length-1;i>=0;i--){let n=a[i];if(n.from<=t.anchor.line&&t.anchor.line<=n.to)return n}return null}onEditorMenu(r,t,a){!t.getSelection()||r.addItem(i=>i.setTitle("Toggle crease").setIcon("shirt").onClick(()=>{this.toggleCrease(t,a)}))}toggleCrease(r,t){r.listSelections().forEach(i=>{let n=this.getRelevantFold(r,i);if(!n)return;let o=n.from,u=r.getLine(o);if(x(u)){let l={line:o,ch:0},c={line:o,ch:this.getFoldTargetPosition(u)},f=u.replace(k,"").trimEnd();r.replaceRange(f,l,c)}else{let l=this.getFoldTargetPosition(u),c={line:o,ch:l},f={line:o,ch:l};r.replaceRange(" %% fold %% ",c,f)}})}getFoldTargetPosition(r){let t=r.length,a=Ch.exec(r);return a&&(t=a.index-1),t}getCreasesFromFile(r){return g(this,null,function*(){let a=(yield this.app.vault.cachedRead(r)).split(`
`),i=[];for(let n=0;n<=a.length;n++){let o=a[n];x(o)&&i.push({from:n,to:n+1})}return i})}getCreasesFromEditor(r){let t=[];for(let a=0;a<=r.lastLine();a++){let i=r.getLine(a);x(i)&&t.push({from:a,to:a+1})}return t}foldCreasesForView(r){return g(this,null,function*(){var i;let t=r.currentMode.getFoldInfo(),a=[...(i=t==null?void 0:t.folds)!=null?i:[],...this.getCreasesFromEditor(r.editor)];r.currentMode.applyFoldInfo({folds:a,lines:r.editor.lineCount()})})}foldCreasesForFile(r){return g(this,null,function*(){var u,l,c;let t=yield this.app.vault.cachedRead(r),a=yield this.app.foldManager.load(r),n={folds:[...(u=a==null?void 0:a.folds)!=null?u:[],...yield this.getCreasesFromFile(r)],lines:(c=(l=t.match(/^/gm))==null?void 0:l.length)!=null?c:0},o=this.app.workspace.getLeavesOfType("markdown").filter(f=>f.view&&f.view instanceof C.MarkdownView&&f.view.file===r);o.length?o[0].view.currentMode.applyFoldInfo(n):yield this.app.foldManager.save(r,n)})}toggleFoldForHeadingLevel(r,t){var u,l,c;let a=(l=(u=r.currentMode.getFoldInfo())==null?void 0:u.folds)!=null?l:[],i=(((c=this.app.metadataCache.getFileCache(r.file))==null?void 0:c.headings)||[]).filter(f=>f.level===t),n=new Set(i.map(f=>f.position.start.line)),o=i[0].position.start;if(a.find(f=>f.from===o.line))r.currentMode.applyFoldInfo({folds:a.filter(f=>!n.has(f.from)),lines:r.editor.lineCount()}),r.onMarkdownFold();else{let f=[...a,...i.map(d=>({from:d.position.start.line,to:d.position.start.line+1}))];r.currentMode.applyFoldInfo({folds:f,lines:r.editor.lineCount()}),r.onMarkdownFold()}}creaseCurrentFolds(r,t){var n;let a=t.currentMode.getFoldInfo(),i=[];((n=a==null?void 0:a.folds)!=null?n:[]).forEach(o=>{let u=r.getLine(o.from);if(!x(u)){let l={line:o.from,ch:this.getFoldTargetPosition(u)};i.push({text:" %% fold %%",from:l,to:l})}}),r.transaction({changes:i})}clearCreases(r,t){let a=[];for(let i=0;i<r.lastLine();i++){let n=r.getLine(i);x(n)&&a.push({text:n.replace(k,""),from:{line:i,ch:0},to:{line:i,ch:n.length}})}r.transaction({changes:a})}loadSettings(){return g(this,null,function*(){this.settings=Object.assign({},as,yield this.loadData())})}saveSettings(){return g(this,null,function*(){yield this.saveData(this.settings)})}registerSettingsTab(){this.addSettingTab(new He(this.app,this))}};
